{% if businesses and businesses.count > 0 %}
<div class="bg-white p-4 mb-6 rounded-lg shadow-sm">
    <div class="flex flex-col md:flex-row md:items-center gap-4">
        <div class="font-medium text-gray-700">Business Filter:</div>
        <div class="flex-1">
            <select id="business-filter" class="form-select w-full md:w-auto rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                <option value="all">All Businesses</option>
                {% for business in businesses %}
                <option value="{{ business.id }}" {% if business.id == selected_business_id %}selected{% endif %}>
                    {{ business.name }}
                </option>
                {% endfor %}
            </select>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const businessFilter = document.getElementById('business-filter');
        
        businessFilter.addEventListener('change', function() {
            // Get current URL
            const url = new URL(window.location.href);
            
            // Update the business parameter
            if (this.value === 'all') {
                url.searchParams.delete('business');
            } else {
                url.searchParams.set('business', this.value);
            }
            
            // Clear branch parameter when business changes (let user reselect)
            url.searchParams.delete('branch');
            
            // Redirect to the new URL
            window.location.href = url.toString();
        });
    });
</script>
{% endif %} 