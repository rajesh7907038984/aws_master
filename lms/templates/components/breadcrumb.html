{% comment %}
    Standardized Breadcrumb Component
    
    Usage:
    {% include 'components/breadcrumb.html' with breadcrumbs=breadcrumbs %}
    
    Where breadcrumbs is a list of dictionaries with:
    - 'url': The URL to link to (optional for last item)
    - 'label': The text to display
    - 'icon': Font Awesome icon class (optional)
    
    Example:
    {% with breadcrumbs=my_breadcrumbs %}
        {% include 'components/breadcrumb.html' %}
    {% endwith %}
    
    my_breadcrumbs = [
        {'url': '/', 'label': 'Dashboard', 'icon': 'fa-home'},
        {'url': '/courses/', 'label': 'Courses', 'icon': 'fa-book'},
        {'label': 'Course Name'}
    ]
{% endcomment %}

<style>
    .mobile-breadcrumb {
        display: flex;
        align-items: center;
        font-size: 0.875rem;
        color: #6b7280;
        margin-bottom: 1.5rem;
        overflow-x: auto;
        padding: 0.5rem 0;
        scrollbar-width: none;
        -ms-overflow-style: none;
        gap: 0.5rem;
    }
    
    .mobile-breadcrumb::-webkit-scrollbar {
        display: none;
    }
    
    .breadcrumb-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        white-space: nowrap;
        flex-shrink: 0;
    }
    
    .breadcrumb-link {
        display: flex;
        align-items: center;
        color: #6b7280;
        text-decoration: none;
        padding: 0.5rem 0.75rem;
        border-radius: 0.375rem;
        transition: all 0.15s ease;
        min-height: 36px;
        gap: 0.5rem;
    }
    
    .breadcrumb-link:hover {
        color: #2563eb;
        background-color: #eff6ff;
    }
    
    .breadcrumb-current {
        display: flex;
        align-items: center;
        color: #111827;
        font-weight: 600;
        padding: 0.5rem 0.75rem;
        min-height: 36px;
        gap: 0.5rem;
    }
    
    .breadcrumb-icon {
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 50%;
        background-color: #eff6ff;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        transition: background-color 0.15s ease;
    }
    
    .breadcrumb-link:hover .breadcrumb-icon {
        background-color: #dbeafe;
    }
    
    .breadcrumb-separator {
        color: #9ca3af;
        flex-shrink: 0;
        margin: 0 0.25rem;
    }
    
    /* Mobile optimizations */
    @media (max-width: 640px) {
        .mobile-breadcrumb {
            font-size: 0.8rem;
            margin-bottom: 1rem;
            padding: 0.25rem 0;
        }
        
        .breadcrumb-link,
        .breadcrumb-current {
            min-height: 44px; /* Touch-friendly */
            padding: 0.625rem 0.75rem;
        }
        
        .breadcrumb-icon {
            width: 1.25rem;
            height: 1.25rem;
        }
        
        /* Hide middle items on small screens */
        .breadcrumb-item:not(:first-child):not(:last-child):not(:nth-last-child(2)) {
            display: none;
        }
        
        /* Add ellipsis when items are hidden */
        .breadcrumb-item:nth-child(2):not(:last-child):not(:nth-last-child(2)):before {
            content: "...";
            color: #9ca3af;
            margin: 0 0.5rem;
            font-weight: 600;
        }
    }
    
    /* Very small screens - simplified breadcrumb */
    @media (max-width: 480px) {
        .breadcrumb-item:not(:last-child) {
            display: none;
        }
        
        .mobile-breadcrumb::before {
            content: "‚Üê Back";
            color: #3b82f6;
            cursor: pointer;
            padding: 0.625rem 0.75rem;
            border-radius: 0.375rem;
            transition: background-color 0.15s ease;
            margin-right: 0.5rem;
            min-height: 44px;
            display: flex;
            align-items: center;
        }
        
        .mobile-breadcrumb::before:hover {
            background-color: #eff6ff;
        }
    }
</style>

<div class="mobile-breadcrumb">
    {% for item in breadcrumbs %}
        <div class="breadcrumb-item">
            {% if not forloop.first %}
                <svg class="breadcrumb-separator w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            {% endif %}
            
            {% if item.url and not forloop.last %}
                <a href="{{ item.url }}" class="breadcrumb-link">
                    {% if item.icon %}
                    <div class="breadcrumb-icon">
                        <i class="fas {{ item.icon }} text-[#2F80ED] text-xs"></i>
                    </div>
                    {% endif %}
                    <span>{{ item.label }}</span>
                </a>
            {% else %}
                <span class="breadcrumb-current">
                    {% if item.icon %}
                    <div class="breadcrumb-icon">
                        <i class="fas {{ item.icon }} text-[#2F80ED] text-xs"></i>
                    </div>
                    {% endif %}
                    <span>{{ item.label }}</span>
                </span>
            {% endif %}
        </div>
    {% endfor %}
</div>

<script>
    // Handle mobile back navigation
    document.addEventListener('DOMContentLoaded', function() {
        const breadcrumbs = document.querySelectorAll('.mobile-breadcrumb');
        
        breadcrumbs.forEach(breadcrumb => {
            breadcrumb.addEventListener('click', function(e) {
                // Only handle clicks on the ::before pseudo-element area
                if (window.innerWidth <= 480 && e.target === breadcrumb && e.offsetX < 100) {
                    if (window.history.length > 1) {
                        window.history.back();
                    } else {
                        // Fallback navigation
                        const links = breadcrumb.querySelectorAll('.breadcrumb-link');
                        if (links.length > 0) {
                            const lastLink = links[links.length - 1];
                            window.location.href = lastLink.href;
                        }
                    }
                }
            });
        });
    });
</script> 