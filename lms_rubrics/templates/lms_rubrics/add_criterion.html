{% extends 'base.html' %}

{% block content %}
<div class="container max-w-5xl mx-auto">
    <!-- Breadcrumbs -->
    {% include 'components/breadcrumb.html' with breadcrumbs=breadcrumbs %}
    
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-800">Add Criterion to Rubric</h1>
        <p class="text-gray-600">Adding criterion to: <span class="font-medium">{{ rubric.title }}</span></p>
    </div>

    <div class="bg-white shadow rounded-lg overflow-hidden">
        <form method="post" class="p-6">
            {% csrf_token %}
            
            <div class="mb-6">
                <label for="description" class="block text-gray-700 text-sm font-bold mb-2">Criterion Description:</label>
                <textarea id="description" name="description" rows="3" required class="w-full p-2 border rounded-md focus:border-blue-500 focus:ring-1 focus:ring-blue-500">{% if outcome %}{{ outcome.title }}{% endif %}</textarea>
                {% if outcome %}
                <div class="mt-2 text-xs text-blue-600">
                    <p>This criterion was created from outcome: {{ outcome.title }}</p>
                </div>
                {% endif %}
            </div>
            
            <div class="mb-6">
                <label for="points" class="block text-gray-700 text-sm font-bold mb-2">Points:</label>
                <input type="number" id="points" name="points" value="{% if outcome %}{{ outcome.mastery_points }}{% else %}4{% endif %}" min="0" step="0.1" required class="w-full p-2 border rounded-md focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                {% if outcome and outcome.calculation_method == 'no_point' %}
                <div class="mt-2 text-xs text-blue-600">
                    <p>This outcome uses a "No Point" rating system (Met/Not Met). A value of 1 is recommended.</p>
                </div>
                {% endif %}
            </div>
            
            <div class="mb-6">
                <label class="flex items-center">
                    <input type="checkbox" name="use_range" class="form-checkbox h-5 w-5 text-blue-600">
                    <span class="ml-2 text-gray-700">Use Range</span>
                </label>
                <p class="text-xs text-gray-500 mt-1">If checked, this criterion will be scored using a range rather than specific ratings.</p>
            </div>
            
            <div class="flex justify-end space-x-3">
                <a href="{% url 'lms_rubrics:edit' rubric_id=rubric.id %}" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                    Cancel
                </a>
                <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                    Add Criterion
                </button>
            </div>
        </form>
    </div>
</div>

{% if outcome and outcome.calculation_method == 'no_point' %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // For "no_point" outcome, suggest a point value of 1
        const pointsInput = document.getElementById('points');
        if (pointsInput.value == "0") {
            pointsInput.value = "1";
        }
    });
</script>
{% endif %}
{% endblock %}